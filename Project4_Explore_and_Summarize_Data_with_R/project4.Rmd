Red Wine Quality analysis by Harish Garg
========================================================

```{r echo=FALSE, message=FALSE, warning=FALSE, packages}
# Load all of the packages that you end up using
# in your analysis in this code chunk.

# Notice that the parameter "echo" was set to FALSE for this code chunk.
# This prevents the code from displaying in the knitted HTML output.
# You should set echo=FALSE for all code chunks in your file.

library(ggplot2)
library(gridExtra)
```

```{r echo=FALSE, Load_the_Data}
# Load the Data
wines <- read.csv("wineQualityReds.csv")
```

# Univariate Plots Section
## Plots
```{r echo=FALSE, message=FALSE, warning=FALSE, Univariate_Plots}
  
for (i in 2:12){
    d = density(wines[,i])
    p1 = qplot(d$x, d$y/sum(d$y), geom = "line") + 
        xlab(names(wines)[i]) + 
        ylab("Probability Density") +
        ggtitle(paste("Distribution of",names(wines)[i]))
        
    p2 = ggplot(wines, aes( x = 1, y = wines[i] ) ) + 
               ylab(names(wines[i])) +
               geom_jitter(alpha = 0.1 ) +
               geom_boxplot(alpha = 0.2, color = 'red' ) +
               ggtitle(paste("Boxplot of outliers for",names(wines)[i]))
    
    grid.arrange(p1, p2, ncol=2)
    print(paste("Summary of", names(wines[i])))
    print(summary(wines[,i]))
}

print("Summary of Quality")
summary(wines$quality)
table(wines$quality)

```
### Observations
Below are some of the observations on the above plots:

* density and pH seem to have a normal distribution.

* residual.sugar, chlorides, and sulphates seems to have a long tail on the positive side.

* fixed.acidity, volatile.acidity, citric.acid, free.sulfur.dioxide, total.sulfur.dioxide and alcohol seem to have an approx poisson distribution.


# Univariate Analysis

### What is the structure of your dataset?
This dataset has 1599 observations and 13 variables. These 1599 observations correspond to 1599 types of red wines. 

### What is/are the main feature(s) of interest in your dataset?
* "quality" is the dependent variable.
* Rest of the 12 variables are independent variables.
We will using the how the 12 independent variables relate to the depedent variable i.e. quality.

### What other features in the dataset do you think will help support your investigation into your feature(s) of interest?
Let's begin with finding the correlation between each independent variable and the depedent variable.

```{r echo=FALSE, message=FALSE, warning=FALSE}
abs(round(cor(wines),3))[-12,"quality"]
```

Results seems to suggest we don't none of the indepedent variables have strong correlation with the quality. So, we would need to work with mutiple independent variables to see if we get a stronger correlation with quality.

### Did you create any new variables from existing variables in the dataset?
Not yet. Maybe will update this section, if I do create more variables.

### Of the features you investigated, were there any unusual distributions? Did you perform any operations on the data to tidy, adjust, or change the form of the data? If so, why did you do this?

We are going to turn the quality variable into a factor as this will help us make it a classfication problem.

```{r echo=FALSE, message=FALSE, warning=FALSE}
wines$quality = as.factor(wines$quality)
```

# Bivariate Plots Section
## Plots
```{r echo=FALSE, message=FALSE, warning=FALSE, Bivariate_Plots}
p <- ggplot(aes(factor(quality), 
             alcohol), 
        data = wines) +
        xlab("quality") +
        geom_jitter( alpha = .3)  +
        geom_boxplot( alpha = .5,color = 'blue')+
        stat_summary(fun.y = "mean", 
               geom = "point", 
               color = "red", 
               shape = 8, 
               size = 4)

for (i in 2:12){
    p <-p %+% aes(y = wines[i]) +
        ylab(names(wines[i])) +
        ggtitle(paste(names(wines[i]), "by quality"))
    plot(p)    
}

abs(round(cor(wines[,-c(12,13)]),3))

```
## Observations

* Variables that don't change much with quality - fixed.acidity, resdiual.sugar, chlorides
* Variables that decrease as the quality gets higher - volatile.acidity, density, pH
* Variables that increase as the quality gets higher - citric.acid, sulphates, alcohol
* There is a strong relationship between pH and fixed.acidity(0.683)

# Bivariate Analysis

### Talk about some of the relationships you observed in this part of the investigation. How did the feature(s) of interest vary with other features in the dataset?

volatile.acidity, density, pH, citric.acid, sulphates and alcohol values change as the quality changes.

### Did you observe any interesting relationships between the other features (not the main feature(s) of interest)?

### What was the strongest relationship you found?
The strongest relationship is between pH and fixed.acidity(0.683)

# Multivariate Plots Section
## Plots
```{r echo=FALSE, message=FALSE, warning=FALSE, Multivariate_Plots}
multi_varients <- combn(names(wines)[-c(12,13)],2)
for (i in 1:ncol(multi_varients)){
  p <- ggplot(aes(y=wines[,multi_varients[2,i]],
                  x=wines[,multi_varients[1,i]], 
                  colour = factor(quality)), data = wines) +
          xlab(multi_varients[1,i]) +
          ylab(multi_varients[2,i]) +
          geom_point(alpha = 0.8, size = 2) +
          geom_smooth(method = "lm", se = FALSE,size=1)  +
                scale_color_brewer(type='seq',
                guide=guide_legend(title='Quality')) +
          ggtitle(paste(multi_varients[1,i], "by",
                        multi_varients[2,i], "colored by quality"))
  plot(p)
}

```

## Observations
Here, we are trying to find the correct combination of variables to distinguish the high quality wines from low quality. We talk about the analysis below.

# Multivariate Analysis

### Talk about some of the relationships you observed in this part of the investigation. Were there features that strengthened each other in terms of looking at your feature(s) of interest?

Below variables, together seems to have a interesting relationships for distingushing between higher quality and lower quality wines
- alcohol & chlorides
- alcohol & volatile.acidity
- alcohol & sulphates
- sulphates & volatile.acidity

### Were there any interesting or surprising interactions between features?
No, didn't see any worth mentioning.

### OPTIONAL: Did you create any models with your dataset? Discuss the strengths and limitations of your model.

------

# Final Plots and Summary

### Plot One
```{r echo=FALSE, warning=FALSE,Plot_One}
ggplot(aes(x = quality), data = wines)  +
  geom_bar() +
  ggtitle("Number of Wines by Quality")

```

### Description One
A very high number of wines are of the the quality 5 or 6(> 4/5ths).

### Plot Two
```{r echo=FALSE, message=FALSE, warning=FALSE, Plot_Two}
bi_plot <- ggplot(aes(factor(quality), 
                volatile.acidity), 
            data = wines) +
            xlab("quality") +
            geom_jitter( alpha = .3)  +
            geom_boxplot( alpha = .5,color = 'blue')+
            stat_summary(fun.y = "mean", 
                 geom = "point", 
                 color = "red", 
                 shape = 8, 
                 size = 4)
            
volatile_acidity <- bi_plot %+% aes(y = volatile.acidity) +
    ggtitle("Quality vs Volatile Acidity")

alcohol <- bi_plot %+% aes(y = alcohol) +
              ylab("Alcohol %") +
              ggtitle("Quality vs Alcohol")

citric_acid <- bi_plot %+% aes(y = citric.acid) +
    ggtitle("Quality vs Citric Acid")

density <- bi_plot %+% aes(y = density) +
    ggtitle("Quality vs Density")

ph <- bi_plot %+% aes(y = pH) +
    ggtitle("Quality vs pH")

sulphates <- bi_plot %+% aes(y = sulphates) +
    ggtitle("Quality vs Sulphates")


grid.arrange(volatile_acidity, alcohol, density, sulphates, ph, 
             citric_acid, ncol = 2)

```

### Description Two
As the wine quality increases, the median value of variables sulphates, alcohol & citric.acid increase and the median value of variables volatile.acidity, density & pH decrease.

### Plot Three
```{r echo=FALSE, message=FALSE, warnings=FALSE,  Plot_Three}

p <- ggplot(aes(x = alcohol, 
            y = sulphates  , color = factor(quality)), 
        data = wines) +
        geom_point(alpha = 0.8, size = 2) +
        geom_smooth(method = "lm", se = FALSE,size=1)  +
        scale_color_brewer(type='seq',
                     guide=guide_legend(title='Quality'))

p %+% aes(y=alcohol, x=fixed.acidity, colour = factor(quality)) +
    ggtitle("Alcohol % vs Fixed Acidity colored by Quality")

p %+% aes(y=alcohol, x=volatile.acidity, colour = factor(quality)) +
  ggtitle("Alcohol % vs Volatile Acidity colored by Quality")

p %+% aes(y=alcohol, x=chlorides, colour = factor(quality)) +
  ggtitle("Alcohol % vs chlorides colored by Quality")
  
p %+% aes(y=sulphates, x=volatile.acidity, colour = factor(quality)) +
  ggtitle("Sulphates vs Volatile Acidity colored by Quality")

```

### Description Three
Two variables combinations gives us a little bit of insight into the differenc between wines with higher and lower quality.

------

# Reflection
I started with printing some basis summary of the dataset and plotting the univariate plots. The dataset looked good for analysis so far. However, once I reached the bivariate analysis and trying to find the impact any of the independent variables have on quality, no clear winner emerged, which was quite discouraging in the begining.

In conlusion, We started with trying to find out variables, individually or in combination, that influence the quality of the wine. We conclude that no single variable can by it's own predict the quality of the wine. We would  need to use mutiple variables and do more analysis, proabbly with more data. 
