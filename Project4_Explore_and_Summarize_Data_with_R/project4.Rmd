Red Wine Quality analysis by Harish Garg
========================================================

```{r echo=FALSE, message=FALSE, warning=FALSE, packages}
# Load all of the packages that you end up using
# in your analysis in this code chunk.

# Notice that the parameter "echo" was set to FALSE for this code chunk.
# This prevents the code from displaying in the knitted HTML output.
# You should set echo=FALSE for all code chunks in your file.

library(ggplot2)
library(gridExtra)
```

```{r echo=FALSE, Load_the_Data}
# Load the Data
wines <- read.csv("wineQualityReds.csv")
```

# Univariate Plots Section
```{r echo=FALSE, Univariate_Plots}
head(wines)
dim(wines)
names(wines)
str(wines)
summary(wines)
qplot(data = wines, x = quality)
qplot(data = wines, x = fixed.acidity)
qplot(data = wines, x = volatile.acidity)
qplot(data = wines, x = residual.sugar)
qplot(data = wines, x = chlorides)
qplot(data = wines, x = free.sulfur.dioxide)
qplot(data = wines, x = total.sulfur.dioxide)
qplot(data = wines, x = density)
qplot(data = wines, x = pH)
qplot(data = wines, x = sulphates)
qplot(data = wines, x = alcohol)
summary(wines$quality)
table(wines$quality)
```

# Univariate Analysis

### What is the structure of your dataset?
This dataset has 1599 observations and 13 variables. These 1599 observations correspond to 1599 types of red wines. 

### What is/are the main feature(s) of interest in your dataset?
* "quality" is the dependent variable.
* Rest of the 12 variables are independent variables.
We will using the how the 12 independent variables relate to the depedent variable i.e. quality.

### What other features in the dataset do you think will help support your investigation into your feature(s) of interest?
Let's begin with finding the correlation between each independent variable and the depedent variable.

```{r}
abs(round(cor(wines),3))[-12,"quality"]
```

Results seems to suggest we don't none of the indepedent variables have strong correlation with the quality. So, we would need to work with mutiple independent variables to see if we get a stronger correlation with quality.

### Did you create any new variables from existing variables in the dataset?
Not yet. Maybe will update this section, if I do create more variables.

### Of the features you investigated, were there any unusual distributions? Did you perform any operations on the data to tidy, adjust, or change the form of the data? If so, why did you do this?

We are going to turn the quality variable into a factor as this will help us make it a classfication problem.

```{r}
wines$quality = as.factor(wines$quality)

summary(wines$quality)
table(wines$quality)
```

# Bivariate Plots Section
```{r echo=FALSE, Bivariate_Plots}
ggplot(aes(y=fixed.acidity, x=quality), data=wines) +
    geom_boxplot()

ggplot(aes(y=volatile.acidity, x=quality), data=wines) +
    geom_boxplot()

ggplot(aes(y=citric.acid, x=quality), data=wines) +
    geom_boxplot()

ggplot(aes(y=residual.sugar, x=quality), data=wines) +
    geom_boxplot()

ggplot(aes(y=chlorides, x=quality), data=wines) +
    geom_boxplot()

ggplot(aes(y=free.sulfur.dioxide, x=quality), data=wines) +
    geom_boxplot()

ggplot(aes(y=total.sulfur.dioxide, x=quality), data=wines) +
    geom_boxplot()

ggplot(aes(y=density, x=quality), data=wines) +
    geom_boxplot()

ggplot(aes(y=pH, x=quality), data=wines) +
    geom_boxplot()

ggplot(aes(y=sulphates, x=quality), data=wines) +
    geom_boxplot()

ggplot(aes(y=alcohol, x=quality), data=wines) +
    geom_boxplot()


```

# Bivariate Analysis

### Talk about some of the relationships you observed in this part of the investigation. How did the feature(s) of interest vary with other features in the dataset?


Variables that don't change much with quality..
- fixed.acidity
- resdiual.sugar
- chlorides

Variables that decrease as the quality gets higher...
- volatile.acidity
- density
- pH

Variables that increase as the quality gets higher
- citric.acid
- sulphates
- alcohol


### Did you observe any interesting relationships between the other features (not the main feature(s) of interest)?

### What was the strongest relationship you found?


```{r}
abs(round(cor(wines[,-c(12,13)]),3))
```

The strongest relationship is between pH and fixed.acidity(0.683)

# Multivariate Plots Section

```{r echo=FALSE, Multivariate_Plots}
multi_varients <- combn(names(wines)[-c(12,13)],2)

for (i in 1:ncol(multi_varients)){
  p <- ggplot(aes(y=wines[,multi_varients[2,i]], x=wines[,multi_varients[1,i]], colour = quality), data = wines) +
          geom_point()
  plot(p)
}
```

# Multivariate Analysis

### Talk about some of the relationships you observed in this part of the investigation. Were there features that strengthened each other in terms of looking at your feature(s) of interest?

Below variables, together seems to have a interesting relationships for distingushing between higher quality and lower quality wines
- alcohol & chlorides
- alcohol & volatile.acidity
- alcohol & sulphates
- sulphates & volatile.acidity

### Were there any interesting or surprising interactions between features?
No, didn't see any worth mentioning.

### OPTIONAL: Did you create any models with your dataset? Discuss the strengths and limitations of your model.

------

# Final Plots and Summary

### Plot One
```{r echo=FALSE, Plot_One}
ggplot(aes(x = quality), data = wines)  +
  geom_bar() +
  ggtitle("Number of Wines by Quality")

```

### Description One
A very high number of wines are of the the quality 5 or 6(> 4/5ths).

### Plot Two
```{r echo=FALSE, Plot_Two}
volatile_acidity <- ggplot(aes(y=volatile.acidity, x=quality), data=wines) +
    geom_boxplot() +
    ggtitle("Quality vs Volatile Acidity")
  
citric_acid <-ggplot(aes(y=citric.acid, x=quality), data=wines) +
    geom_boxplot() +
    ggtitle("Quality vs Citric Acid")

density <-ggplot(aes(y=density, x=quality), data=wines) +
    geom_boxplot() +
    ggtitle("Quality vs Density")

ph <-ggplot(aes(y=pH, x=quality), data=wines) +
    geom_boxplot() +
    ggtitle("Quality vs pH")

sulphates <-ggplot(aes(y=sulphates, x=quality), data=wines) +
    geom_boxplot() +
    ggtitle("Quality vs Sulphates")

alcohol <-ggplot(aes(y=alcohol, x=quality), data=wines) +
    geom_boxplot() +
    ggtitle("Quality vs alcohol")

grid.arrange(volatile_acidity, alcohol, density, sulphates, ph, citric_acid, ncol = 2)


```

### Description Two
As the wine quality increases, the median value of variables sulphates, alcohol & citric.acid increase and the median value of variables volatile.acidity, density & pH decrease.

### Plot Three
```{r echo=FALSE, Plot_Three}
plot1 <- ggplot(aes(y=alcohol, x=fixed.acidity, colour = quality), data=wines) +
  geom_point() +
    ggtitle("Alcohol vs Fixed Acidity colored by Quality")

plot2 <- ggplot(aes(y=alcohol, x=volatile.acidity, colour = quality), data=wines) +
  geom_point() +
  ggtitle("Alcohol vs Volatile Acidity colored by Quality")

plot3 <- ggplot(aes(y=alcohol, x=chlorides, colour = quality), data=wines) +
  geom_point() +
  ggtitle("Alcohol vs chlorides colored by Quality")
  
plot4 <- ggplot(aes(y=sulphates, x=volatile.acidity, colour = quality), data=wines) +
  geom_point() +
  ggtitle("Sulphates vs Volatile Acidity colored by Quality")

grid.arrange(plot1, plot2, plot3, plot4, ncol = 2)

```

### Description Three
Two variables combinations gives us a little bit of insight into the differenc between wines with higher and lower quality.

------

# Reflection
We started with trying to find out variables, individually or in combination, that influence the quality of the wine. We conclude that no single variable can by it's own predict the quality of the wine. We would  need to use mutiple variables and do more analysis, proabbly with more data. 
